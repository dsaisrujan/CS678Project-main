
Lmod is automatically replacing "gnu9/9.3.0" with "gnu10/10.3.0-ya".


Inactive Modules:
  1) hosts/hopper     2) hwloc/2.1.0     3) libfabric     4) openmpi4     5) ucx

+ CKPT_NAME=gen-KAIROS
+ MODEL=constrained-gen
+ rm -rf checkpoints/gen-KAIROS-pred
+ python train.py --model=constrained-gen --ckpt_name=gen-KAIROS-pred --load_ckpt=checkpoints/gen-KAIROS/epoch=2.ckpt --dataset=KAIROS --eval_only --mark_trigger --train_file=data/wikievents/train.jsonl --val_file=data/wikievents/dev.jsonl --test_file=data/wikievents/test.jsonl --coref_dir=data/wikievents/coref --train_batch_size=4 --eval_batch_size=4 --learning_rate=3e-5 --accumulate_grad_batches=4 --num_train_epochs=3
12/13/2022 17:20:50 - INFO - __main__ -   Training/evaluation parameters Namespace(model='constrained-gen', dataset='KAIROS', tmp_dir=None, ckpt_name='gen-KAIROS-pred', load_ckpt='checkpoints/gen-KAIROS/epoch=2.ckpt', train_file='data/wikievents/train.jsonl', val_file='data/wikievents/dev.jsonl', test_file='data/wikievents/test.jsonl', input_dir=None, coref_dir='data/wikievents/coref', use_info=False, mark_trigger=True, sample_gen=False, train_batch_size=4, eval_batch_size=4, eval_only=True, learning_rate=3e-05, accumulate_grad_batches=4, weight_decay=0.0, adam_epsilon=1e-08, gradient_clip_val=1.0, num_train_epochs=3, max_steps=-1, warmup_steps=0, gpus=-1, seed=42, fp16=False, threads=1)
Some weights of the model checkpoint at patrickvonplaten/led-large-16384-pubmed were not used when initializing LEDModel: ['final_logits_bias', 'lm_head.weight']
- This IS expected if you are initializing LEDModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LEDModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
GPU available: True, used: True
12/13/2022 17:20:56 - INFO - lightning -   GPU available: True, used: True
TPU available: False, using: 0 TPU cores
12/13/2022 17:20:56 - INFO - lightning -   TPU available: False, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
12/13/2022 17:20:56 - INFO - lightning -   LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.
12/13/2022 17:21:01 - INFO - lightning -   Set SLURM handle signals.
/home/vpeddi3/.local/lib/python3.9/site-packages/pytorch_lightning/utilities/distributed.py:45: UserWarning: The dataloader, test dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 64 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
/home/vpeddi3/.local/lib/python3.9/site-packages/pytorch_lightning/utilities/distributed.py:45: UserWarning: The testing_epoch_end should not return anything as of 9.1.to log, use self.log(...) or self.write(...) directly in the LightningModule
  warnings.warn(*args, **kwargs)
+ python src/genie/scorer.py --gen-file=checkpoints/gen-KAIROS-pred/predictions.jsonl --test-file=data/wikievents/test.jsonl --dataset=KAIROS --coref-file=data/wikievents/coref/test.jsonlines --head-only --coref
  0%|          | 0/364 [00:00<?, ?it/s]  0%|          | 1/364 [00:00<00:46,  7.79it/s]  1%|          | 3/364 [00:00<00:31, 11.45it/s]  1%|▏         | 5/364 [00:00<00:28, 12.55it/s]  2%|▏         | 7/364 [00:00<00:27, 13.07it/s]  2%|▏         | 9/364 [00:00<00:26, 13.33it/s]  3%|▎         | 11/364 [00:00<00:26, 13.50it/s]  4%|▎         | 13/364 [00:01<00:26, 13.35it/s]  4%|▍         | 15/364 [00:01<00:25, 13.47it/s]  5%|▍         | 17/364 [00:01<00:25, 13.57it/s]  5%|▌         | 19/364 [00:01<00:25, 13.62it/s]  6%|▌         | 21/364 [00:01<00:25, 13.68it/s]  6%|▋         | 23/364 [00:01<00:24, 13.73it/s]  7%|▋         | 25/364 [00:01<00:24, 13.77it/s]  7%|▋         | 27/364 [00:02<00:24, 13.84it/s]  8%|▊         | 29/364 [00:02<00:23, 14.43it/s]  9%|▊         | 31/364 [00:02<00:22, 14.83it/s]  9%|▉         | 33/364 [00:02<00:21, 15.16it/s] 10%|▉         | 35/364 [00:02<00:21, 15.41it/s] 10%|█         | 37/364 [00:02<00:21, 15.51it/s] 11%|█         | 39/364 [00:02<00:20, 15.57it/s] 11%|█▏        | 41/364 [00:02<00:20, 15.61it/s] 12%|█▏        | 43/364 [00:03<00:20, 15.71it/s] 12%|█▏        | 45/364 [00:03<00:20, 15.83it/s] 13%|█▎        | 47/364 [00:03<00:19, 15.89it/s] 13%|█▎        | 49/364 [00:03<00:19, 15.91it/s] 14%|█▍        | 51/364 [00:03<00:19, 15.97it/s] 15%|█▍        | 53/364 [00:03<00:19, 15.97it/s] 15%|█▌        | 55/364 [00:03<00:19, 16.00it/s] 16%|█▌        | 57/364 [00:03<00:19, 15.82it/s] 16%|█▋        | 60/364 [00:04<00:16, 18.81it/s] 18%|█▊        | 64/364 [00:04<00:13, 22.45it/s] 19%|█▊        | 68/364 [00:04<00:11, 24.89it/s] 20%|█▉        | 72/364 [00:04<00:10, 26.58it/s] 21%|██        | 76/364 [00:04<00:10, 27.13it/s] 22%|██▏       | 80/364 [00:04<00:10, 28.27it/s] 23%|██▎       | 84/364 [00:04<00:09, 29.08it/s] 24%|██▍       | 88/364 [00:04<00:09, 29.70it/s] 25%|██▌       | 92/364 [00:05<00:09, 30.11it/s] 26%|██▋       | 96/364 [00:05<00:08, 30.42it/s] 27%|██▋       | 100/364 [00:05<00:13, 19.26it/s] 28%|██▊       | 103/364 [00:05<00:19, 13.61it/s] 29%|██▉       | 105/364 [00:06<00:22, 11.63it/s] 29%|██▉       | 107/364 [00:06<00:25, 10.25it/s] 30%|██▉       | 109/364 [00:06<00:27,  9.33it/s] 30%|███       | 111/364 [00:07<00:29,  8.69it/s] 31%|███       | 113/364 [00:07<00:30,  8.21it/s] 31%|███▏      | 114/364 [00:07<00:31,  7.97it/s] 32%|███▏      | 115/364 [00:07<00:31,  7.81it/s] 32%|███▏      | 116/364 [00:07<00:32,  7.67it/s] 32%|███▏      | 117/364 [00:07<00:32,  7.55it/s] 32%|███▏      | 118/364 [00:08<00:33,  7.44it/s] 33%|███▎      | 119/364 [00:08<00:33,  7.37it/s] 33%|███▎      | 120/364 [00:08<00:33,  7.31it/s] 33%|███▎      | 121/364 [00:08<00:33,  7.28it/s] 34%|███▎      | 122/364 [00:08<00:33,  7.25it/s] 34%|███▍      | 123/364 [00:08<00:33,  7.24it/s] 34%|███▍      | 124/364 [00:08<00:33,  7.22it/s] 34%|███▍      | 125/364 [00:09<00:33,  7.22it/s] 35%|███▍      | 126/364 [00:09<00:32,  7.22it/s] 35%|███▍      | 127/364 [00:09<00:32,  7.21it/s] 35%|███▌      | 128/364 [00:09<00:32,  7.18it/s] 35%|███▌      | 129/364 [00:09<00:32,  7.19it/s] 36%|███▌      | 130/364 [00:09<00:32,  7.20it/s] 36%|███▌      | 131/364 [00:09<00:32,  7.20it/s] 36%|███▋      | 132/364 [00:10<00:32,  7.20it/s] 37%|███▋      | 133/364 [00:10<00:32,  7.19it/s] 37%|███▋      | 134/364 [00:10<00:31,  7.19it/s] 37%|███▋      | 135/364 [00:10<00:31,  7.21it/s] 37%|███▋      | 136/364 [00:10<00:31,  7.21it/s] 38%|███▊      | 137/364 [00:10<00:31,  7.21it/s] 38%|███▊      | 139/364 [00:10<00:23,  9.46it/s] 39%|███▊      | 141/364 [00:10<00:19, 11.61it/s] 39%|███▉      | 143/364 [00:11<00:16, 13.28it/s] 40%|███▉      | 145/364 [00:11<00:15, 14.56it/s] 41%|████      | 148/364 [00:11<00:12, 17.44it/s] 42%|████▏     | 152/364 [00:11<00:09, 21.94it/s] 43%|████▎     | 156/364 [00:11<00:08, 25.11it/s] 44%|████▍     | 160/364 [00:11<00:07, 27.33it/s] 45%|████▌     | 164/364 [00:11<00:06, 28.89it/s] 46%|████▌     | 168/364 [00:11<00:06, 29.59it/s] 47%|████▋     | 172/364 [00:12<00:06, 30.58it/s] 48%|████▊     | 176/364 [00:12<00:06, 28.95it/s] 49%|████▉     | 179/364 [00:12<00:07, 26.32it/s] 50%|█████     | 182/364 [00:12<00:07, 24.56it/s] 51%|█████     | 185/364 [00:12<00:07, 23.37it/s] 52%|█████▏    | 188/364 [00:12<00:07, 22.54it/s] 52%|█████▏    | 191/364 [00:12<00:07, 21.97it/s] 53%|█████▎    | 194/364 [00:13<00:07, 21.43it/s] 54%|█████▍    | 197/364 [00:13<00:07, 21.12it/s] 55%|█████▍    | 200/364 [00:13<00:07, 20.93it/s] 57%|█████▋    | 206/364 [00:13<00:05, 28.96it/s] 58%|█████▊    | 211/364 [00:13<00:04, 33.10it/s] 59%|█████▉    | 216/364 [00:13<00:04, 36.34it/s] 61%|██████    | 221/364 [00:13<00:03, 38.76it/s] 62%|██████▏   | 226/364 [00:13<00:03, 40.54it/s] 63%|██████▎   | 231/364 [00:14<00:03, 41.85it/s] 65%|██████▍   | 236/364 [00:14<00:02, 42.81it/s] 66%|██████▌   | 241/364 [00:14<00:03, 31.49it/s] 67%|██████▋   | 245/364 [00:14<00:04, 26.70it/s] 68%|██████▊   | 249/364 [00:14<00:04, 23.91it/s] 69%|██████▉   | 252/364 [00:15<00:04, 22.50it/s] 70%|███████   | 255/364 [00:15<00:05, 21.45it/s] 71%|███████   | 258/364 [00:15<00:05, 20.62it/s] 72%|███████▏  | 261/364 [00:15<00:05, 20.06it/s] 73%|███████▎  | 264/364 [00:15<00:05, 19.66it/s] 73%|███████▎  | 267/364 [00:15<00:05, 19.35it/s] 74%|███████▍  | 269/364 [00:15<00:04, 19.20it/s] 74%|███████▍  | 271/364 [00:16<00:04, 19.07it/s] 75%|███████▌  | 273/364 [00:16<00:04, 18.97it/s] 76%|███████▌  | 275/364 [00:16<00:04, 18.88it/s] 76%|███████▌  | 277/364 [00:16<00:04, 18.78it/s] 77%|███████▋  | 279/364 [00:16<00:04, 17.80it/s] 77%|███████▋  | 281/364 [00:16<00:04, 17.57it/s] 78%|███████▊  | 283/364 [00:16<00:04, 17.44it/s] 78%|███████▊  | 285/364 [00:16<00:04, 17.35it/s] 79%|███████▉  | 287/364 [00:16<00:04, 17.30it/s] 79%|███████▉  | 289/364 [00:17<00:04, 17.26it/s] 80%|███████▉  | 291/364 [00:17<00:04, 17.22it/s] 80%|████████  | 293/364 [00:17<00:04, 17.19it/s] 81%|████████  | 295/364 [00:17<00:04, 16.33it/s] 82%|████████▏ | 297/364 [00:17<00:04, 15.99it/s] 82%|████████▏ | 299/364 [00:17<00:04, 15.79it/s] 83%|████████▎ | 301/364 [00:17<00:04, 15.64it/s] 83%|████████▎ | 303/364 [00:17<00:03, 15.55it/s] 84%|████████▍ | 305/364 [00:18<00:03, 15.47it/s] 84%|████████▍ | 307/364 [00:18<00:03, 15.25it/s] 85%|████████▍ | 309/364 [00:18<00:03, 15.26it/s] 85%|████████▌ | 311/364 [00:18<00:03, 15.28it/s] 86%|████████▌ | 313/364 [00:18<00:03, 16.14it/s] 87%|████████▋ | 317/364 [00:18<00:02, 20.52it/s] 88%|████████▊ | 321/364 [00:18<00:01, 23.52it/s] 89%|████████▉ | 324/364 [00:19<00:02, 17.27it/s] 90%|████████▉ | 326/364 [00:19<00:02, 15.50it/s] 90%|█████████ | 328/364 [00:19<00:02, 14.28it/s] 91%|█████████ | 330/364 [00:19<00:02, 13.36it/s] 91%|█████████ | 332/364 [00:19<00:02, 12.78it/s] 92%|█████████▏| 334/364 [00:20<00:02, 12.33it/s] 92%|█████████▏| 336/364 [00:20<00:02, 12.00it/s] 93%|█████████▎| 338/364 [00:20<00:02, 11.81it/s] 93%|█████████▎| 340/364 [00:20<00:02, 11.70it/s] 94%|█████████▍| 342/364 [00:20<00:01, 11.59it/s] 95%|█████████▍| 344/364 [00:20<00:01, 11.54it/s] 95%|█████████▌| 346/364 [00:21<00:01, 11.49it/s] 96%|█████████▌| 348/364 [00:21<00:01, 11.45it/s] 96%|█████████▌| 350/364 [00:21<00:01, 12.32it/s] 97%|█████████▋| 353/364 [00:21<00:00, 15.78it/s] 98%|█████████▊| 356/364 [00:21<00:00, 18.70it/s]100%|██████████| 364/364 [00:21<00:00, 16.79it/s]
